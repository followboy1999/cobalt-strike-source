package beacon;

import aggressor.AggressorClient;
import beacon.exploits.BypassUAC;
import beacon.exploits.BypassUACToken;
import beacon.exploits.cve_2014_4113;

import java.util.*;

public class BeaconExploits {
    public Map descriptions = new HashMap();
    public Map exploits = new HashMap();

    public void registerDefaults(AggressorClient client) {
        new cve_2014_4113(client);
        new BypassUAC(client);
        new BypassUACToken(client);
    }

    public Exploit getExploit(String name) {
        synchronized (this) {
            return (Exploit) this.exploits.get(name);
        }
    }

    public void register(String command, String description, Exploit implementation) {
        this.descriptions.put(command, description);
        this.exploits.put(command, implementation);
    }

    public boolean isExploit(String name) {
        synchronized (this) {
            return this.exploits.containsKey(name);
        }
    }

    public List exploits() {
        synchronized (this) {
            LinkedList exploits = new LinkedList(this.descriptions.keySet());
            Collections.sort(exploits);
            return exploits;
        }
    }

    public String getDescription(String exploit) {
        synchronized (this) {
            return this.descriptions.get(exploit) + "";
        }
    }

    public interface Exploit {
        void elevate(String var1, String var2);
    }

}

